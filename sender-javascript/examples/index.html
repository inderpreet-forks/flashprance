<!DOCTYPE html>
<html manifest="./cache.manifest">
  <head>
    <title>FlashPrance Demo</title>
    <link rel="stylesheet" href="lib/bootstrap-1.0.0.min.css">
    <script src="lib/jquery-1.5.2.min.js"></script>
    <script src="./flashprance.js"></script>
    <script>
      FlashPrance.debug = true;

      var flashPrance = new FlashPrance();

      flashPrance.ontransmitstart = function() {
        $('#cancel, #progressBar').show();
        $('#transmit').attr('disabled', true);
      };

      flashPrance.ontransmitend = function() {
        $('#cancel, #progressBar').hide();
        $('#bar').css('width', '0%');
        $('#transmit').removeAttr('disabled');
        $('#clock').css('background-color', '#fff');
        $('#data').css('background-color', '#fff');
      };

      flashPrance.ontransmitvalue = function(data, clock) {
        $('#clock').css('background-color', clock ? '#000' : '#fff');
        $('#data').css('background-color', data ? '#000' : '#fff');
      };

      flashPrance.ontransmitprogress = function(progress) {
        $('#bar').css('width', (progress * 100) + '%');
      };

      $(function() {

        // If DOM storage is available, persist
        // text box between page reloads.
        if (window.localStorage) {
          var savedText = localStorage['text'];
          if (savedText) {
            $('#input').val(savedText);
          }
          $('#input').bind('change keyup', function() {
            localStorage['text'] = $('#input').val();
          });
        }

        $('#transmit').click(function() {
          flashPrance.transmitAscii($('#input').val());
        });

        $('#cancel, #flasher').click(function() {
          flashPrance.abortTransmission();
        });

      });
    </script>
    <!-- iPhone tweaks -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name = "viewport" content = "width=device-width">
  </head>
  <body>

    <div class="container">

      <div class="page-header">
        <h1>FlashPrance Demo</h1>
      </div>

      <p>Type some text. Hold device up to outline. Hit transmit.</p>
      <p>
        <input id="input" type="text" class="input-mini" value="Hello" maxlength="100">
        <button class="btn primary" id="transmit">Transmit</button>
        <button class="btn" id="cancel" style="display:none">Cancel</button>
      </p>

      <div style="position: relative; border: 1px dashed #666666; width: 140px; height: 140px; margin-top: 40px; border-radius: 100%;">
        <div id="data"  style="position: absolute; top: 0; bottom: 0; left: 0; right: 0; margin: 20%; -border: 1px dashed #aaaaaa; border-radius: 100%;"></div>
        <div id="clock" style="position: absolute; top: 0; bottom: 0; left: 0; right: 0; margin: 40%; -border: 1px dashed #aaaaaa; border-radius: 100%;"></div>
      </div>

      <div id="progressBar" style="margin-top: 30px; width: 140px; height:
          20px; border: 1px solid #000000; display:none">
        <div id="bar" style="height: 100%; background-color: #0064CD"></div>
      </div>

    </div>

  </body>
</html>
